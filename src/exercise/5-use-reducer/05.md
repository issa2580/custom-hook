# use reducer

Voici un hook totalement sous-cot√©.

Dans cet exercice, on va utiliser **toute la puissance**. Il faut savoir que quand
j'ai appris React c'est celui qui m'a pos√© le plus probl√®me. Je vais essayer
de rendre son concept le plus simple possible.

[üìñ Doc de useReducer](https://react.dev/reference/react/useReducer)

![use reduce flow](../../../public/assets/use-reduce-flow.png)

_J'explique ce flow dans la vid√©o d'intro._

> C'est quoi la diff√©rence avec useState ?

`useState` est une version limit√©e de `useReducer`, regarde :

(En acceptant que `initialValue` ne soit pas une fonction)

```js
const reducer = (prevValue, newValue) => {
  // On peut aussi passer une fonction dans le `setState`
  if (typeof newValue === 'function') {
    return newValue(prevValue);
  }
  return newValue;
};

const useState = (initialValue) => {
  const [state, setState] = React.useReducer(reducer, initialValue);
  return [state, setState];
};
```

Finalement, ce reduce est une sorte de `super useState` pour
r√©aliser tous tes r√™ves et tes d√©sirs.

√Ä vrai dire, `useState` est simplement une configuration par d√©faut de `useReducer`.

[üìñ React hooks system](https://the-guild.dev/blog/react-hooks-system)

## Exercice 1 - Counter

Nous avons un counter qui ne fonctionne pas pour l'instant, fais
le fonctionner.
Quand tu cliques sur le compteur, il doit s'incr√©menter de 1.

üíå Tu apprends l'usage le plus basique du `useReducer`.

## Extra 2 - Bouton moins !

Maintenant ajoute un deuxi√®me button : le button moins !

Quand tu cliques dessus, il doit d√©cr√©menter de 1.

ü¶Å Tu vas devoir modifier la fonction `reducer` pour qu'elle
s'adapte √† l'action qui est pass√©e en param√®tre.

üí° Tips de code :

```js
switch (action) {
  case 'increment':
  // ...
  case 'decrement':
  // ...
  default:
  // ...
}
```

- üíå Tu apprends √† g√©rer un reducer en fonction d'une action !

## Extra 3 - Refactor et reset

Pour cet exercise, 3 choses :

1. Ajoute un button `reset` avec une nouvelle action : `reset` qui reset le compteur √† 0.
2. Cr√©e une constante qui contient chaque Action (`increment`, `decrement`, `reset`)
   et utilise ces constantes au lieu de string

üí° Tips de code :

```js
const REDUCER_ACTIONS = {
  INCREMENT: 'increment',
  // ...
};
```

- üíå Tu apprends √† ajouter des actions qui ne se basent pas sur la valeur du state.
- üíå Tu apprends √† refactor ton code pour √©viter des probl√®mes.

PS : TypeScript r√©sout bien mieux ce probl√®me qu'avec une constante.

## Extra 4 - De 5 en 5 !

Ajoute deux nouveaux boutons :

- `+5` qui increment de **5**
- `-5` qui decrement de **5**

Pour √ßa, ne rajoute pas de nouvelles actions, mais plut√¥t ajoute
un param√®tre √† notre action.

üí° Tips de code :

```js
const reducer = (value, { action, value }) => {
  /*...*/
};
```

üí° Il faut que tu refactor chaque appel √† notre dispatch !

üíå Tu apprends √† ajouter 1 param√®tre dans l'action.

## Extra 5 - One line

Je te propose un extra qui est directement dans le fichier markdown.

Remplace le `useState` + la fonction qui le modifie des exemples ci-dessous
par un `useReducer` !

Voici [une codesandbox](https://codesandbox.io/s/use-reducer-extra-5-exercise-hqgxgb)
pour que tu puisses tester.

### Toggle

Un toggle qui peut passer de `true` √† `false` !

```jsx
const Toggle = () => {
  const [isOn, setIsOn] = useState(false);

  const toggle = () => {
    setIsOn((curr) => !curr);
  };

  return <button onClick={toggle}>{isOn ? 'ON' : 'OFF'}</button>;
};
```

### One-way boolean

Un bouton `false` par d√©faut qui ne peut qu'√™tre mis √† `true`.

```jsx
const Enabled = () => {
  const [isEnabled, setIsEnabled] = useState(false);

  const enabled = () => {
    setIsOn(true);
  };

  return <button onClick={enabled}>{isEnabled ? 'ON' : 'OFF'}</button>;
};
```

### Increment state

Un compteur qui ne peut qu'√™tre incr√©ment√© !

```jsx
const Increment = () => {
  const [count, setCount] = useState(0);

  const increment = () => {
    setIsOn((curr) => curr + 1);
  };

  return <button onClick={increment}>{count}</button>;
};
```

[Codesandbox solution](https://codesandbox.io/s/use-reducer-extra-5-solution-f94p5k)

## Bonus

Tu veux aller encore plus loin ?

Tu peux rajouter un input pour `set` la value, avec une action set.

Pas de vid√©o correction pour √ßa, tu peux partager sur le Discord !
